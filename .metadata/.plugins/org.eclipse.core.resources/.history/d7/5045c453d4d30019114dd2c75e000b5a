'''
Created on 2019年9月10日

@author: 静火
'''
def importData(path):
    # 数据库
    createDataBase()
    database = sqlite3.connect("check.db")

    #文件类型
    wildcard = ".xls"

    list = getFileList(path,wildcard,1)

    nfiles = len(list[0])
    #文件名
    file = list[0]
    #时间
    time = list[1]
    #省份
    province = list[2]
    # #文件类型
    FileType = list[3]

    for count in range(0,nfiles):
        filename = file[count]
        check_province = changeCode(province[count])
        check_time = time[count]
        File_type = changeCode(FileType[count])
        readExcel(filename,database,check_province,check_time,File_type)

if __name__ == '__main__':
    if len(sys.argv) != 2:
        print "Wrong Parameters"
    else:
        path = sys.argv[1]
        importData(path)